<!DOCTYPE html>
<html>
    <head>
        <style type="text/css">
            .anexo-obrigatorio {
                box-shadow: 0px 1px 10px #dc7373;
            }

            .compras #tabelaHistorico_wrapper td {
                /* font-size: 15px; */
                padding: 5px;
            }

            .compras legend {
                border-bottom: 1px solid black;
            }

            .compras ul.abas {
                border-bottom: 1px solid #dcdddc;
                padding-left: 10px;
            }

            .compras ul.abas li {
                list-style-type: none;
                display: inline-block;
                border-top: 1px solid #dcdddc;
                border-right: 1px solid #dcdddc;
                border-left: 1px solid #dcdddc;
                padding: 10px;
                border-top-left-radius: 8px;
                border-top-right-radius: 8px;
            }

            .compras .abas a {
                text-decoration: none;
            }

            .compras label {
                width: 100%;
                color: #004791;
                font-weight: bold;
            }

            .compras .portlet-body {
                background: rgba(255, 255, 255, 1);
                background: -moz-linear-gradient(
                    45deg,
                    rgba(255, 255, 255, 1) 0%,
                    rgba(242, 245, 248, 1) 20%,
                    rgba(255, 255, 255, 1) 20%,
                    rgba(255, 255, 255, 1) 21%,
                    rgba(242, 245, 248, 1) 34%,
                    rgba(242, 245, 248, 1) 51%,
                    rgba(255, 255, 255, 1) 51%,
                    rgba(242, 245, 248, 1) 77%,
                    rgba(255, 255, 255, 1) 77%,
                    rgba(242, 245, 248, 1) 98%,
                    rgba(255, 255, 255, 1) 100%
                );
                background: -webkit-gradient(
                    left bottom,
                    right top,
                    color-stop(0%, rgba(255, 255, 255, 1)),
                    color-stop(20%, rgba(242, 245, 248, 1)),
                    color-stop(20%, rgba(255, 255, 255, 1)),
                    color-stop(21%, rgba(255, 255, 255, 1)),
                    color-stop(34%, rgba(242, 245, 248, 1)),
                    color-stop(51%, rgba(242, 245, 248, 1)),
                    color-stop(51%, rgba(255, 255, 255, 1)),
                    color-stop(77%, rgba(242, 245, 248, 1)),
                    color-stop(77%, rgba(255, 255, 255, 1)),
                    color-stop(98%, rgba(242, 245, 248, 1)),
                    color-stop(100%, rgba(255, 255, 255, 1))
                );
                background: -webkit-linear-gradient(
                    45deg,
                    rgba(255, 255, 255, 1) 0%,
                    rgba(242, 245, 248, 1) 20%,
                    rgba(255, 255, 255, 1) 20%,
                    rgba(255, 255, 255, 1) 21%,
                    rgba(242, 245, 248, 1) 34%,
                    rgba(242, 245, 248, 1) 51%,
                    rgba(255, 255, 255, 1) 51%,
                    rgba(242, 245, 248, 1) 77%,
                    rgba(255, 255, 255, 1) 77%,
                    rgba(242, 245, 248, 1) 98%,
                    rgba(255, 255, 255, 1) 100%
                );
                background: -o-linear-gradient(
                    45deg,
                    rgba(255, 255, 255, 1) 0%,
                    rgba(242, 245, 248, 1) 20%,
                    rgba(255, 255, 255, 1) 20%,
                    rgba(255, 255, 255, 1) 21%,
                    rgba(242, 245, 248, 1) 34%,
                    rgba(242, 245, 248, 1) 51%,
                    rgba(255, 255, 255, 1) 51%,
                    rgba(242, 245, 248, 1) 77%,
                    rgba(255, 255, 255, 1) 77%,
                    rgba(242, 245, 248, 1) 98%,
                    rgba(255, 255, 255, 1) 100%
                );
                background: -ms-linear-gradient(
                    45deg,
                    rgba(255, 255, 255, 1) 0%,
                    rgba(242, 245, 248, 1) 20%,
                    rgba(255, 255, 255, 1) 20%,
                    rgba(255, 255, 255, 1) 21%,
                    rgba(242, 245, 248, 1) 34%,
                    rgba(242, 245, 248, 1) 51%,
                    rgba(255, 255, 255, 1) 51%,
                    rgba(242, 245, 248, 1) 77%,
                    rgba(255, 255, 255, 1) 77%,
                    rgba(242, 245, 248, 1) 98%,
                    rgba(255, 255, 255, 1) 100%
                );
                background: linear-gradient(
                    45deg,
                    rgba(255, 255, 255, 1) 0%,
                    rgba(242, 245, 248, 1) 20%,
                    rgba(255, 255, 255, 1) 20%,
                    rgba(255, 255, 255, 1) 21%,
                    rgba(242, 245, 248, 1) 34%,
                    rgba(242, 245, 248, 1) 51%,
                    rgba(255, 255, 255, 1) 51%,
                    rgba(242, 245, 248, 1) 77%,
                    rgba(255, 255, 255, 1) 77%,
                    rgba(242, 245, 248, 1) 98%,
                    rgba(255, 255, 255, 1) 100%
                );
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#ffffff', GradientType=1 );
            }

            .form-compra input,
            .form-compra select,
            .form-compra textarea,
            .form-solicitante input,
            .form-solicitante select,
            .form-solicitante textarea {
                margin-bottom: 25px;
            }

            .table input {
                margin-bottom: 0;
            }

            .compras .table td {
                padding: 0;
            }

            .compras .portlet-title {
                background: rgba(229, 240, 110, 1);
                background: -moz-linear-gradient(
                    top,
                    rgba(229, 240, 110, 1) 0%,
                    rgba(206, 221, 70, 1) 25%,
                    rgba(206, 221, 70, 1) 74%,
                    rgba(214, 219, 120, 1) 100%
                );
                background: -webkit-gradient(
                    left top,
                    left bottom,
                    color-stop(0%, rgba(229, 240, 110, 1)),
                    color-stop(25%, rgba(206, 221, 70, 1)),
                    color-stop(74%, rgba(206, 221, 70, 1)),
                    color-stop(100%, rgba(214, 219, 120, 1))
                );
                background: -webkit-linear-gradient(
                    top,
                    rgba(229, 240, 110, 1) 0%,
                    rgba(206, 221, 70, 1) 25%,
                    rgba(206, 221, 70, 1) 74%,
                    rgba(214, 219, 120, 1) 100%
                );
                background: -o-linear-gradient(
                    top,
                    rgba(229, 240, 110, 1) 0%,
                    rgba(206, 221, 70, 1) 25%,
                    rgba(206, 221, 70, 1) 74%,
                    rgba(214, 219, 120, 1) 100%
                );
                background: -ms-linear-gradient(
                    top,
                    rgba(229, 240, 110, 1) 0%,
                    rgba(206, 221, 70, 1) 25%,
                    rgba(206, 221, 70, 1) 74%,
                    rgba(214, 219, 120, 1) 100%
                );
                background: linear-gradient(
                    to bottom,
                    rgba(229, 240, 110, 1) 0%,
                    rgba(206, 221, 70, 1) 25%,
                    rgba(206, 221, 70, 1) 74%,
                    rgba(214, 219, 120, 1) 100%
                );
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#e5f06e', endColorstr='#d6db78', GradientType=0 );
                border: 1px solid #d3dcc8;
            }

            .campo-obrigatorio {
                box-shadow: 0px 0px 7px 2px #cb4949;
            }

            .tabela-grid {
                padding-right: 0;
                padding-left: 0;
            }

            .abaMover {
                border: 1px solid #dedede;
                height: 25px;
                width: 15px;
                text-align: right;
                float: right;
                background: #efefef;
            }

            .tabela-cronograma td {
                border-right: 0.03px solid white;
            }

            .cor_atividade {
                background: rgb(248, 98, 41);
            }

            .atividade {
                height: 20px;
            }

            .grid_dll {
                width: fit-content;
            }

            .processo {
                height: 13px;
            }

            .processo.bg-success {
                background-color: #fcfb00 !important;
            }

            #cronograma td[class*='td1'] input,
            #cronograma td[class*='td6'] input,
            #cronograma td[class*='td7'] input {
                width: 60px;
            }

            #cronograma td[class*='td2'] input {
                width: 170px;
            }

            #cronograma td[class*='td3'] input {
                width: 110px;
            }

            #cronograma td[class*='td4'] input,
            #cronograma td[class*='td5'] input {
                width: 110px;
            }

            #cronograma td[class*='td'] input,
            #cronograma td[class='acoes'] [data-js*='cronograma_tr'] {
                height: 34.3px;
            }

            #numeroRv td[class*='td1'] input {
                min-width: 200px;
                height: 36px;
            }

            #cronograma td[class='acoes'] [data-js*='cronograma_tr'] {
                line-height: 1.6;
            }

            #numeroRv td[class='acoes'] [data-js*='numeroRv_tr'] {
                line-height: 1.6;
                width: 50px;
                color: #FFF;
                border-radius: 0;
            }

            .vr-acaoes {
                width: 60px;
                justify-content: center;
            }

            #numeroRv td.acoes label.btn-icon-only {
                width: 100%;
            }

            .table-cronograma {
                border: 1px solid #a4a2a2;
            }

            .table-cronograma .th_mother-ano th {
                padding: 30px 10px 10px 10px;
                font-size: 1.5em;
                color: #686e73;
                border: #a4a2a2;
                border: 2px solid #a4a2a2;
            }

            .table-cronograma .th_dias-semana th {
                padding: 1px 6.2px 1px 6.2px;
                width: 60px;
                text-align: center;
                font-size: 1.2em;
                color: #583f3d;
                border: 2px solid #a4a2a2;
            }

            .table-cronograma tbody td {
                border: 2px solid #a4a2a2;
                padding-top: 1px;
                padding-bottom: 2px;
            }

            .btn-scroll {
                display: flex;
                position: fixed;
                text-align: right;
            }

            .btn-scroll span {
                height: 30px;
                width: 30px;
                margin: 2px 3px 4px 5px;
                border: 1px solid #b5b5b2ab;
                border-radius: 5px;
                line-height: 2;
                text-align: center;
                cursor: pointer;
                /* font-size: 1.2em; */
                box-shadow: 1px 2px 2px 0px rgba(135, 125, 125, 0.5);
            }

            .btn-primary {
                color: white !important;
            }

            .col-sm-12.tabela-grid-conograma {
                width: fit-content;
            }

            #tabelaHistorico_filter {
                float: right;
            }

            .sweet-alert,
            .sweet-overlay {
                z-index: 30000;
            }

            .no--uppercase {
                text-transform: none !important;
            }
        </style>

        <script id="scriptInput" type="text/javascript">
            $('body').ready(function() {
                $(document).ajaxComplete(function() {
                    $('body .formulario-upload').each(function() {
                        var input = $(this);
                        var ck = $(this).parent();
                        if (ck.length > 0) {
                            $('.tipoAnexoId').each(function() {
                                var id = $(this).data('tipo-anexo-id');
                                if (id == input.data('tipo-anexo-id')) {
                                    ck.removeClass(
                                        'fa-ban font-red-thunderbird'
                                    );
                                    ck.addClass('fa-check font-green-jungle');
                                }
                            });
                        }
                    });
                });
            });
        </script>
    </head>

    <body>
        <div class="compras container-fluid" style="padding: 0">
            <div class="col-md-12" style="padding: 0">
                <!-- BEGIN Portlet PORTLET-->
                <div class="portlet box blue-hoki">
                    <div class="portlet-title">
                        <div class="caption" style="color: #004791;">
                            <i class="fa fa-gift"></i>Solicita&ccedil;&atilde;o
                            de Compras
                        </div>

                        <div class="actions">&nbsp;</div>
                    </div>

                    <div class="portlet-body">
                        <div
                            class="slimScrollDiv scrollDiv"
                            style="position: relative; overflow: hidden; width: auto; height: auto"
                        >
                            <div
                                class="scroller"
                                data-handle-color="#a1b2bd"
                                data-initialized="1"
                                data-rail-color="yellow"
                                data-rail-visible="1"
                                style="height: auto; overflow: hidden; width: auto;"
                            >
                                <form role="form" style="padding: 10px">
                                    <div class="form-body">
                                        <div class="row">
                                            <div
                                                class="form-group"
                                                style="margin-bottom: 100px"
                                            >
                                                <div class="col-sm-3">
                                                    <span
                                                        class="h-card"
                                                        data-campo-altura="10"
                                                        data-campo-classe="form-control"
                                                        data-campo-estilo=""
                                                        data-campo-largura="200"
                                                    >
                                                        <span
                                                            class="form-group form-md-line-input"
                                                        >
                                                            <label
                                                                for="CAMPO_9"
                                                            >
                                                                N&ordm;
                                                                Solicita&ccedil;&atilde;o
                                                                <input
                                                                    class="form-control"
                                                                    data-campo-id="@@9@@"
                                                                    id="CAMPO_9"
                                                                    style="width: auto; border-bottom: none;"
                                                                    type="text"
                                                                />
                                                            </label>
                                                        </span>
                                                    </span>
                                                </div>

                                                <div class="col-sm-3">
                                                    <span
                                                        class="h-card"
                                                        data-campo-altura="10"
                                                        data-campo-classe="form-control"
                                                        data-campo-estilo=""
                                                        data-campo-largura="200"
                                                        ><span
                                                            class="form-group form-md-line-input  "
                                                            ><label
                                                                for="CAMPO_10"
                                                                >Data da
                                                                Solicita&ccedil;&atilde;o<!-- label--><input
                                                                    class="form-control"
                                                                    data-campo-id="@@10@@"
                                                                    id="CAMPO_10"
                                                                    style="width: auto; border-bottom: none;"
                                                                    type="text"/></label></span
                                                    ></span>
                                                </div>

                                                <div class="col-md-3">
                                                    <span
                                                        class="h-card"
                                                        data-campo-altura="10"
                                                        data-campo-classe="form-control"
                                                        data-campo-estilo=""
                                                        data-campo-largura="200"
                                                        ><span
                                                            class="form-group form-md-line-input  "
                                                            ><label
                                                                for="CAMPO_1"
                                                                >Usu&aacute;rio
                                                                Logado<!-- label--><input
                                                                    class="form-control"
                                                                    data-campo-id="@@1@@"
                                                                    id="CAMPO_1"
                                                                    style="width: auto; border-bottom: none;"
                                                                    type="text"/></label></span
                                                    ></span>

                                                    <div
                                                        class="form-control-focus"
                                                    >
                                                        &nbsp;
                                                    </div>
                                                </div>

                                                <div class="col-md-3">
                                                    <span
                                                        class="h-card"
                                                        data-campo-altura="10"
                                                        data-campo-classe="form-control"
                                                        data-campo-estilo=""
                                                        data-campo-largura="200"
                                                        ><span
                                                            class="form-group form-md-line-input  "
                                                            ><label
                                                                for="CAMPO_2"
                                                                >Departamento<!-- label--><input
                                                                    class="form-control"
                                                                    data-campo-id="@@2@@"
                                                                    id="CAMPO_2"
                                                                    style="width: auto; border-bottom: none;"
                                                                    type="text"/></label></span
                                                    ></span>

                                                    <div
                                                        class="form-control-focus"
                                                    >
                                                        &nbsp;
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div style="display:none">
                                            <span
                                                class="h-card"
                                                data-campo-altura="10"
                                                data-campo-classe=""
                                                data-campo-estilo=""
                                                data-campo-largura="200"
                                                style="display:block;"
                                                ><span
                                                    class="form-group form-md-line-input "
                                                    ><input
                                                        class="form-control"
                                                        data-campo-id="@@59@@"
                                                        id="@@59@@"
                                                        placeholder=" "
                                                        style="width:200px;"
                                                        type="text"/></span></span
                                            ><span
                                                class="h-card"
                                                data-campo-altura="10"
                                                data-campo-classe=""
                                                data-campo-estilo=""
                                                data-campo-largura="200"
                                                style="display:block;"
                                                ><span
                                                    class="form-group form-md-line-input "
                                                    ><input
                                                        class="form-control"
                                                        data-campo-id="@@58@@"
                                                        id="@@58@@"
                                                        placeholder=" "
                                                        style="width:200px;"
                                                        type="text"/></span
                                            ></span>
                                        </div>

                                        <hr />
                                    </div>
                                </form>
                            </div>

                            <div class="form-row">
                                <ul class="abas">
                                    <li style="background-color: #d6ddff;">
                                        <a class="aba aba-solicitante" href="#"
                                            >Dados da Solicitante</a
                                        >
                                    </li>
                                    <li>
                                        <a class="aba aba-compra" href="#">
                                            Dados da Compra
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <!--DADOS DO SOLICITANTE-->

                            <div
                                class="form-group form-solicitante"
                                style="margin-bottom: 70px"
                            >
                                <fieldset>
                                    <legend>Dados do Solicitante</legend>

                                    <div class="form-group">
                                        <div class="col-sm-6">
                                            <label>RE</label>
                                            <span
                                                class="h-card"
                                                data-campo-altura="10"
                                                data-campo-classe=""
                                                data-campo-estilo=""
                                                data-campo-largura="200"
                                                style="display:block;"
                                                ><span
                                                    class="form-group form-md-line-input "
                                                    ><input
                                                        class="form-control"
                                                        data-campo-id="@@36@@"
                                                        id="CAMPO_36"
                                                        placeholder=" "
                                                        type="text"/></span
                                            ></span>
                                        </div>

                                        <div class="col-sm-6">
                                            <label>Nome</label>
                                            <span
                                                class="h-card"
                                                data-campo-altura="10"
                                                data-campo-classe=""
                                                data-campo-estilo=""
                                                data-campo-largura="200"
                                                style="display:block;"
                                                ><span
                                                    class="form-group form-md-line-input "
                                                    ><input
                                                        class="form-control"
                                                        data-campo-id="@@37@@"
                                                        id="CAMPO_37"
                                                        placeholder=" "
                                                        type="text"/></span
                                            ></span>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="col-sm-6">
                                            <label>E-mail</label>
                                            <span
                                                class="h-card"
                                                data-campo-altura="10"
                                                data-campo-classe=""
                                                data-campo-estilo=""
                                                data-campo-largura="200"
                                                style="display:block;"
                                                ><span
                                                    class="form-group form-md-line-input "
                                                    ><input
                                                        class="form-control"
                                                        data-campo-id="@@38@@"
                                                        id="@@38@@"
                                                        placeholder=" "
                                                        type="text"/></span
                                            ></span>
                                        </div>

                                        <div class="col-sm-6">
                                            <label>Telefone</label>
                                            <span
                                                class="h-card"
                                                data-campo-altura="10"
                                                data-campo-classe=""
                                                data-campo-estilo=""
                                                data-campo-largura="200"
                                                style="display:block;"
                                                ><span
                                                    class="form-group form-md-line-input "
                                                    ><input
                                                        class="form-control"
                                                        data-campo-id="@@39@@"
                                                        id="@@39@@"
                                                        placeholder=" "
                                                        type="text"/></span
                                            ></span>
                                        </div>
                                    </div>

                                    <div class="form-group col-sm-12">
                                        <div
                                            class="col-sm-6"
                                            style="padding-left: 0"
                                        >
                                            <label>&Aacute;rea</label>
                                            <span
                                                class="h-card"
                                                data-campo-altura="10"
                                                data-campo-classe=""
                                                data-campo-estilo=""
                                                data-campo-largura="200"
                                                style="display:block;"
                                                ><span
                                                    class="form-group form-md-line-input "
                                                    ><input
                                                        class="form-control"
                                                        data-campo-id="@@40@@"
                                                        id="CAMPO_40"
                                                        placeholder=" "
                                                        type="text"/></span
                                            ></span>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>

                            <!--DADOS DA COMPRA-->
                            <div class="form-compra">
                                <fieldset class="padding-tb-20">
                                    <legend> Informa&ccedil;&otilde;es gerais </legend>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Empresa </label>
                                            <select class="form-control" data-campo-id="@@11@@" id="@@11@@"></select>
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Tipo de Compra</label>
                                            <select class="form-control" data-campo-id="@@12@@" id="@@12@@"></select>
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Modelo de Compra</label>
                                            <select class="form-control" data-campo-id="@@13@@" id="CAMPO_13"></select>
                                        </div>
                                    </div>

                                    <div class="col-sm-6 acm_tbra">
                                        <div class="form-group">
                                            <label>ACM TBRA</label>
                                            <input class="form-control" data-campo-id="@@50@@" id="@@50@@" />
                                        </div>
                                    </div>
                                </fieldset>

                                <fieldset class="padding-tb-20">
                                    <legend> Informa&ccedil;&otilde;es Sobre o Projeto </legend>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Nome de Projeto</label>
                                            <input class="form-control" data-campo-id="@@15@@" id="@@15@@"/>
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Estrutura Beneficiada</label>
                                            <select class="form-control" data-campo-id="@@16@@" id="CAMPO_16" ></select>
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>&Aacute;rea Beneficiada </label>
                                            <select class="form-control" data-campo-id="@@17@@" id="CAMPO_17"></select>
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Gestor do Contrato</label>
                                            <select class="form-control" data-campo-id="@@68@@" id="CAMPO_68"></select>
                                        </div>

                                        <div style="display:none">
                                            <input class="form-control" data-campo-id="@@19@@" id="@@19@@" type="text"/>
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Objeto</label>
                                            <textarea class="form-control" cols="60" data-campo-id="@@18@@" id="@@18@@" name="message" rows="10"></textarea>
                                        </div>
                                    </div>
                                </fieldset>

                                <fieldset class="padding-tb-20">
                                    <legend> Dados dos Fornecedores Envolvidos </legend>

                                    <div class="row">
                                        <div class="col-sm-6">
                                            <div class=" form-group">
                                                <label>Sele&ccedil;&atilde;o de Fornecedores</label>
                                                <select class="form-control" data-campo-id="@@20@@" id="@@20@@"></select>
                                            </div>
                                        </div>

                                        <div class="col-sm-12">
                                            <div class="form-group">
                                                <button class="indicacao btn btn-primary">
                                                    Indica&ccedil;&atilde;o de fornecedor?
                                                </button>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="dados-fornecedor-indicado">
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label>Raz&atilde;o Social</label>
                                                    <input class="form-control" data-campo-id="@@51@@" id="@@51@@" type="text"/>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label>CNPJ do fornecedor</label>
                                                    <input class="form-control" data-campo-id="@@22@@" id="@@22@@" type="text"/>
                                                </div>
                                            </div>

                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label>Pessoa para contato</label>
                                                    <input class="form-control" data-campo-id="@@23@@" id="@@23@@" type="text"/>
                                                </div>
                                            </div>

                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label>Telefone para contato</label>
                                                    <input class="form-control" data-campo-id="@@35@@" id="@@35@@" type="text"/>
                                                </div>
                                            </div>

                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label>Email para contato</label>
                                                    <input class="form-control" data-campo-id="@@24@@" id="@@24@@" type="text"/>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-xs-6">
                                                <button type="button" class="btn btn-primary btn-sm js-onClickAddFornecedor">
                                                    Adicionar Fornecedor
                                                </button>
                                            </div>

                                            <div class="col-xs-6">
                                                <button type="button" class="btn btn-danger btn-sm js-onClickRemoverFornecedor">
                                                    Remover Fornecedor
                                                </button>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-xs-12">
                                                <div class="js-contentFornecedorIndicacao2" style="padding-top: 3em; display: none;">
                                                    <legend></legend>
                                                    <div class="row">
                                                        <div class="col-sm-6">
                                                            <div class="form-group">
                                                                <label>Razão Social</label>
                                                                <input
                                                                    type="text"
                                                                    class="form-control"
                                                                    data-campo-id="@@73@@"
                                                                    id="@@73@@"
                                                                />
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-sm-6">
                                                            <div class="form-group">
                                                                <label>CNPJ do fornecedor</label>
                                                                <input
                                                                    type="text"
                                                                    class="form-control"
                                                                    data-campo-id="@@74@@"
                                                                    id="@@74@@"
                                                                />
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-6">
                                                            <div class="form-group">
                                                                <label>Pessoa para contato</label>
                                                                <input
                                                                    type="text"
                                                                    class="form-control"
                                                                    data-campo-id="@@75@@"
                                                                    id="@@75@@"
                                                                />
                                                            </div>
                                                        </div>

                                                        <div class="col-sm-6">
                                                            <div class="form-group">
                                                                <label>Telefone para contato</label>
                                                                <input type="text"
                                                                    class="form-control"
                                                                    data-campo-id="@@76@@"
                                                                    id="@@76@@"
                                                                />
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-6">
                                                            <div class="form-group">
                                                                <label>Email para contato</label>
                                                                <input
                                                                    type="text"
                                                                    class="form-control email"
                                                                    data-campo-id="@@77@@"
                                                                    id="@@77@@"
                                                                />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>

                                <fieldset class="padding-tb-20">
                                    <legend>Dados do Contrato</legend>

                                    <div class="form-group">
                                        <div
                                            class="col-sm-5"
                                            style="padding-left: 0"
                                        >
                                            <div
                                                class="form-group  col-sm-12"
                                                style="padding-left: 0; margin-bottom:0"
                                            >
                                                <div
                                                    class="col-sm-6"
                                                    style="padding-left: 0;"
                                                >
                                                    <label
                                                        >N&uacute;mero do
                                                        Contrato SAP</label
                                                    >
                                                    <span
                                                        class="h-card"
                                                        data-campo-altura="10"
                                                        data-campo-classe=""
                                                        data-campo-estilo=""
                                                        data-campo-largura="200"
                                                        style="display:block;"
                                                        ><span
                                                            class="form-group form-md-line-input "
                                                            ><input
                                                                class="form-control"
                                                                data-campo-id="@@52@@"
                                                                id="@@52@@"
                                                                placeholder=" "
                                                                type="text"/></span
                                                    ></span>
                                                </div>
                                            </div>
                                            <!--  <div class="form-group col-sm-10" style="padding-left: 0">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <div class="table-responsive" data-campo-id="@@32@@">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <table class="table table-striped table-bordered table-hover">                                                                                                                                                                                                                                           </div>-->

                                            <div class="form-group">
                                                <table class="table table-striped table-bordered table-hover grid_dll" id="numeroRv">
                                                    <thead>
                                                        <tr data-cabecalho-container="">
                                                            <th data-elem="input" data-type="text" scope="col">
                                                                N&uacute;mero da
                                                                RV
                                                            </th>
                                                            <th
                                                                class="vr-acaoes"
                                                                scope="col"
                                                            >
                                                                A&ccedil;&otilde;es
                                                            </th>
                                                        </tr>
                                                    </thead>

                                                    <tbody class="inputs" data-corpo-container=""></tbody>

                                                    <tfoot>
                                                        <tr>
                                                            <td colspan="2">
                                                                <label
                                                                    class="btn btn-primary no--uppercase js-addNumeroRv"
                                                                    data-js="numeroRv"
                                                                    width="100">
                                                                    ADICIONAR
                                                                </label>
                                                            </td>
                                                        </tr>
                                                    </tfoot>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>

                                <fieldset class="padding-tb-20">
                                    <legend>
                                        Informa&ccedil;&otilde;es de Prazos e
                                        Prorroga&ccedil;&otilde;es
                                    </legend>

                                    <div class="form-group">
                                        <div class="col-sm-6">
                                            <h4>Vig&ecirc;ncia</h4>

                                            <div
                                                class="col-sm-6"
                                                style="padding-left:0;"
                                            >
                                                <label>De:</label>
                                                <span
                                                    class="h-card"
                                                    data-campo-altura="10"
                                                    data-campo-classe=""
                                                    data-campo-estilo=""
                                                    data-campo-largura="200"
                                                    style="display:block;"
                                                    ><span
                                                        class="form-group form-md-line-input "
                                                        ><input
                                                            class="form-control"
                                                            data-campo-id="@@28@@"
                                                            id="@@28@@"
                                                            placeholder="28 - De (vigência)"
                                                            type="date"/></span
                                                ></span>
                                            </div>

                                            <div class="col-sm-6">
                                                <label>At&eacute;:</label>
                                                <span
                                                    class="h-card"
                                                    data-campo-altura="10"
                                                    data-campo-classe=""
                                                    data-campo-estilo=""
                                                    data-campo-largura="200"
                                                    style="display:block;"
                                                    ><span
                                                        class="form-group form-md-line-input "
                                                        ><input
                                                            class="form-control"
                                                            data-campo-id="@@29@@"
                                                            id="@@29@@"
                                                            placeholder="29 - até (vigência)"
                                                            type="date"/></span
                                                ></span>
                                            </div>
                                        </div>

                                        <div class="col-sm-6">
                                            <h4>
                                                Vig&ecirc;ncia p&oacute;s
                                                Prorroga&ccedil;&atilde;o
                                            </h4>

                                            <div
                                                class="col-sm-6"
                                                style="padding-left:0;"
                                            >
                                                <label>De:</label>
                                                <span
                                                    class="h-card"
                                                    data-campo-altura="10"
                                                    data-campo-classe=""
                                                    data-campo-estilo=""
                                                    data-campo-largura="200"
                                                    style="  display:block;"
                                                    ><span
                                                        class="form-group form-md-line-input "
                                                        ><input
                                                            class="form-control"
                                                            data-campo-id="@@30@@"
                                                            id="@@30@@"
                                                            placeholder="30 - de (vigência pós prorrogação)"
                                                            type="date"/></span
                                                ></span>
                                            </div>

                                            <div class="col-sm-6">
                                                <label>At&eacute;:</label>
                                                <span
                                                    class="h-card"
                                                    data-campo-altura="10"
                                                    data-campo-classe=""
                                                    data-campo-estilo=""
                                                    data-campo-largura="200"
                                                    style="display:block;"
                                                    ><span
                                                        class="form-group form-md-line-input "
                                                        ><input
                                                            class="form-control"
                                                            data-campo-id="@@31@@"
                                                            id="@@31@@"
                                                            placeholder="31 - até (vigência final pós prorrogação)"
                                                            type="date"/></span
                                                ></span>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>

                                <fieldset class="field-anexos padding-tb-20">
                                    <legend>Anexos</legend>

                                    <div class="form-group">
                                        <div class="col-sm-2">
                                            <label
                                                class="btn btn-light label-input-file"
                                                for="MEMORANDO-CONDICIONAMENTO"
                                                >M. Condicionamento</label
                                            ><span
                                                class="h-card fa fa-ban font-red-thunderbird"
                                                style="display: none;"
                                                ><i></i
                                                ><input
                                                    class="file-path formulario-upload validate "
                                                    converterparaimagem="false"
                                                    data-arquivo-nome=""
                                                    data-tipo-anexo-id="4"
                                                    id="MEMORANDO-CONDICIONAMENTO"
                                                    multiple="multiple"
                                                    name="MEMORANDO-CONDICIONAMENTO"
                                                    style="display: inline-block;"
                                                    type="file"
                                            /></span>
                                        </div>

                                        <div class="col-sm-2">
                                            <label
                                                class="btn btn-light label-input-file"
                                                for="PROJETO-BASICO"
                                                >Projeto B&aacute;sico</label
                                            ><span
                                                class="h-card fa fa-ban font-red-thunderbird"
                                                style="display: none;"
                                                ><i></i
                                                ><input
                                                    class="file-path formulario-upload validate "
                                                    converterparaimagem="false"
                                                    data-arquivo-nome=""
                                                    data-tipo-anexo-id="5"
                                                    id="PROJETO-BASICO"
                                                    multiple="multiple"
                                                    name="PROJETO-BASICO"
                                                    style="display: inline-block;"
                                                    type="file"
                                            /></span>
                                        </div>

                                        <div class="col-sm-2">
                                            <label
                                                class="btn btn-light label-input-file"
                                                for="PXQ"
                                                >Pxq</label
                                            ><span
                                                class="h-card fa fa-ban font-red-thunderbird"
                                                style="display: none;"
                                                ><i></i
                                                ><input
                                                    class="file-path formulario-upload validate "
                                                    converterparaimagem="false"
                                                    data-arquivo-nome=""
                                                    data-tipo-anexo-id="6"
                                                    id="PXQ"
                                                    multiple="multiple"
                                                    name="PXQ"
                                                    style="display: inline-block;"
                                                    type="file"
                                            /></span>
                                        </div>

                                        <div class="col-sm-2">
                                            <label
                                                class="btn btn-light label-input-file"
                                                for="ACORDO-CDG"
                                                >De Acordo Cdg</label
                                            ><span
                                                class="h-card fa fa-ban font-red-thunderbird"
                                                style="display: none;"
                                                ><i></i
                                                ><input
                                                    class="file-path formulario-upload validate "
                                                    converterparaimagem="false"
                                                    data-arquivo-nome=""
                                                    data-tipo-anexo-id="10"
                                                    id="ACORDO-CDG"
                                                    multiple="multiple"
                                                    name="ACORDO-CDG"
                                                    style="display: inline-block;"
                                                    type="file"
                                            /></span>
                                        </div>

                                        <div class="col-sm-2">
                                            <label
                                                class="btn btn-light label-input-file"
                                                for="RV-APROVADA"
                                                >rv Aprovada</label
                                            ><span
                                                class="h-card fa fa-ban font-red-thunderbird"
                                                style="display: none;"
                                                ><i></i
                                                ><input
                                                    class="file-path formulario-upload validate "
                                                    converterparaimagem="false"
                                                    data-arquivo-nome=""
                                                    data-tipo-anexo-id="9"
                                                    id="RV-APROVADA"
                                                    multiple="multiple"
                                                    name="RV-APROVADA"
                                                    style="display: inline-block;"
                                                    type="file"
                                            /></span>
                                        </div>

                                        <div class="col-sm-2">
                                            <label
                                                class="btn btn-light label-input-file"
                                                for="OUTROS-ANEXOS"
                                                >Outros Anexos</label
                                            ><span
                                                class="h-card fa fa-ban font-red-thunderbird"
                                                style="display: none;"
                                                ><i></i
                                                ><input
                                                    class="file-path formulario-upload validate "
                                                    converterparaimagem="false"
                                                    data-arquivo-nome=""
                                                    data-tipo-anexo-id="7"
                                                    id="OUTROS-ANEXOS"
                                                    multiple="multiple"
                                                    name="OUTROS-ANEXOS"
                                                    style="display: inline-block;"
                                                    type="file"
                                            /></span>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                            <!--fim dados da compra-->

                            <fieldset class="historico">
                                <legend>Hist&oacute;rico</legend>

                                <div class="col-sm-6">
                                    <label>Observa&ccedil;&otilde;es</label
                                    ><textarea
                                        class="form-control"
                                        cols="60"
                                        id="obs"
                                        rows="5"
                                    ></textarea>
                                </div>

                                <div
                                    class="col-sm-12"
                                    id="templateTabelaHistorico"
                                    style="margin-top: 30px"
                                >
                                    <fieldset>
                                        <legend>Hist&oacute;rico</legend>

                                        <div class="row">
                                            <div class="col-md-12">
                                                <table
                                                    class="table table-striped table-bordered"
                                                    id="tabelaHistorico"
                                                >
                                                    <thead>
                                                        <tr role="row">
                                                            <th
                                                                colspan="1"
                                                                data-column-index="0"
                                                                rowspan="1"
                                                                style="width: 10%;"
                                                                tabindex="0"
                                                            >
                                                                Data Hora
                                                            </th>
                                                            <th
                                                                colspan="1"
                                                                data-column-index="1"
                                                                rowspan="1"
                                                                style="width: 15%;"
                                                                tabindex="0"
                                                            >
                                                                Usu&aacute;rio
                                                            </th>
                                                            <th
                                                                colspan="1"
                                                                data-column-index="1"
                                                                rowspan="1"
                                                                style="width: 60%;"
                                                                tabindex="0"
                                                            >
                                                                Hist&oacute;rico
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </fieldset>
                                </div>
                                <span
                                    class="h-card"
                                    data-campo-altura="10"
                                    data-campo-classe=""
                                    data-campo-estilo=""
                                    data-campo-largura="200"
                                    style="display:block;"
                                    ><span
                                        class="form-group form-md-line-input "
                                        ><input
                                            class="form-control"
                                            data-campo-id="@@49@@"
                                            id="@@49@@"
                                            placeholder="49 - Data SLA"
                                            style="display: none; width:200px;"
                                            type="date"/></span
                                ></span>

                                <div style="display: none;">
                                    <span
                                        class="h-card"
                                        data-campo-altura="10"
                                        data-campo-classe=""
                                        data-campo-estilo=""
                                        data-campo-html="1"
                                        data-campo-largura="200"
                                        style="display:block;"
                                        ><span
                                            class="form-group form-md-line-input "
                                            ><textarea
                                                class="form-control"
                                                cols="60"
                                                data-campo-id="@@34@@"
                                                id="CAMPO_34"
                                                name="message"
                                                placeholder="34 - Historico"
                                                rows="10"
                                            >
                                            </textarea></span
                                    ></span>
                                </div>
                            </fieldset>

                            <div
                                class="slimScrollBar"
                                style="background: rgb(161, 178, 189); width: 7px; position: absolute; top: 0px; opacity: 0.4; display: none; border-radius: 7px; z-index: 99; right: 1px; height: 124.611px;"
                            >
                                &nbsp;
                            </div>

                            <div
                                class="slimScrollRail"
                                style="width: 7px; height: 100%; position: absolute; top: 0px; border-radius: 7px; background: yellow; opacity: 0.2; z-index: 90; right: 1px; display: none;"
                            >
                                &nbsp;
                            </div>
                        </div>
                    </div>

                    <div style="display: none">
                        <span
                            class="h-card"
                            data-campo-altura="10"
                            data-campo-classe=""
                            data-campo-estilo=""
                            data-campo-largura="200"
                            style="display:none;"
                            ><span class="form-group form-md-line-input "
                                ><input
                                    class="form-control"
                                    data-campo-id="@@62@@"
                                    id="@@62@@"
                                    placeholder=" "
                                    style="width:200px;"
                                    type="text"/></span
                        ></span>

                        <div style="display: none">
                            <span
                                class="h-card"
                                data-campo-altura="10"
                                data-campo-classe=""
                                data-campo-estilo=""
                                data-campo-largura="200"
                                style="display:block;"
                                ><span class="form-group form-md-line-input "
                                    ><input
                                        class="form-control"
                                        data-campo-id="@@57@@"
                                        id="@@57@@"
                                        placeholder=" "
                                        style="width:200px;"
                                        type="text"/></span
                            ></span>
                        </div>

                        <div class="form-group" style="display: none;">
                            <label for="CAMPO_69">69 - gestorAprovadorId</label
                            ><input
                                class="form-control"
                                data-campo-id="@@69@@"
                                data-nome="69 - gestorAprovadorId"
                                data-tipo-documental-id="35"
                                id="CAMPO_69"
                                type="text"
                            />
                        </div>
                    </div>

                    <div style="display: none">
                        <div class="form-group" style="display: none">
                            <label for="CAMPO_71">71 - fornecedoresCampos</label
                            ><textarea
                                class="form-control"
                                data-campo-id="@@71@@"
                                data-nome="71 - fornecedoresCampos"
                                data-tipo-documental-id="35"
                                id="CAMPO_71"
                                rows="10"
                            ></textarea>
                        </div>
                    </div>
                </div>
                <!-- END Portlet PORTLET-->
            </div>
        </div>

        <script>
            //arquivo formulario.tabelaGrid escuta esse evento
            var tabelaGrid = new FormularioTabelaGrid();

            tabelaGrid.setConfigTabela({
                nameTable: 'numeroRv',
                orderBy: false,
                enableExclusion: true
            });

            var FormularioFase1 = (function () {

                var controles = {
                    addNumeroRv: '.js-addNumeroRv',

                    inputs: {
                        campo01: '#CAMPO_1',
                        campo02: '#CAMPO_2',
                        campo09: '#CAMPO_9',
                        campo10: '#CAMPO_10',
                        campo13: '#CAMPO_13',
                        campo16: '#CAMPO_16',
                        campo17: '#CAMPO_17',
                        campo22: '#CAMPO_22',
                        campo36: '#CAMPO_36',
                        campo37: '#CAMPO_37',
                        campo51: '#CAMPO_51',
                        campo68: '#CAMPO_68',
                        campo69: '#CAMPO_69',
                    }
                };

                var anexosRealizados = new Set();
                var anexosObrigatorios = new Set();
                var contadorFuncao = 0;
                var contadorGravarHist = 0;
                var solicitacaoAtv1 = null;

                function init () {
                    FormularioAnexo.init();
                    FormularioAnexo.setStore({ anexosRealizados: anexosRealizados });

                    registrarEventos();
                }

                function registrarEventos () {

                    Ecm.registraEvento('change', controles.inputs.campo13, onChangeCampo13);
                    Ecm.registraEvento('change', controles.inputs.campo16, onChangeCampo16);
                    Ecm.registraEvento('change', controles.inputs.campo17, onChangeCampo17);
                    Ecm.registraEvento('change', controles.inputs.campo68, onChangeCampo68);

                    Ecm.registraEvento('keyup change', controles.inputs.campo51, verficaCampoPreenchido);
                    Ecm.registraEvento('keyup change', controles.inputs.campo22, verficaCampoPreenchido);

                    Ecm.registraEvento('click', '.aba-compra', onClickAbaCompra);
                    Ecm.registraEvento('click', '.aba-solicitante', onClickAbaSolicitante);
                    Ecm.registraEvento('click', controles.addNumeroRv, onClickAddNumeroRv);
                    Ecm.registraEvento('click', '.indicacao', onClickIndicacao);
                    Ecm.registraEvento('click', '.js-onClickAddFornecedor', onClickAddFornecedor);
                    Ecm.registraEvento('click', '.js-onClickRemoverFornecedor', onClickRemoverFornecedor);

                    $(document.body).find('click', '#modal-form button.btn--close-right[data-dismiss="modal"]', onClickCloseModal);

                    setTimeout(() => $('.compras input, .compras textarea').removeAttr('placeholder'), 200);
                    setTimeout(() => $('#cke_CAMPO_34').hide(), 200);
                    setTimeout(() => $('.gestorContrato').prop('required', true), 1000);
                    setTimeout(carregarHistoricoNaTabela, 200);

                    setTimeout(() => {
                        $('#CAMPO_1').val(`${Ecm.retornaUsuario().id} - ${Ecm.retornaUsuario().nome}`);
                        $('#CAMPO_2').val(Ecm.retornaUsuario().grupos.split(',')[0]);
                    }, 200);

                    setTimeout(() => {
                        verificarCampoPreenchido($('#CAMPO_59'), Ecm.retornaUsuario().id);
                        verificarCampoPreenchido($('#CAMPO_58'), DocumentoVisualizacaoForm.documentoId());
                        verificarCampoPreenchido($('#CAMPO_36'), Ecm.retornaUsuario().login);
                        verificarCampoPreenchido($('#CAMPO_37'), Ecm.retornaUsuario().nome);
                        verificarCampoPreenchido($('#CAMPO_38'), Ecm.retornaUsuario().email);
                        verificarCampoPreenchido($('#CAMPO_39'), Ecm.retornaUsuario().contato);
                        verificarCampoPreenchido($('#CAMPO_57'), Ecm.retornaUsuario().id);
                        verificarCampoPreenchido($('#CAMPO_40'), Ecm.retornaUsuario().grupos.split(',')[0]);
                        tabelaGrid.listarGridSalvoNoBanco();
                    }, 1000);

                    setTimeout(() => {
                        //se estiver na primeira atividade, ou estiver em outra mas não fora indicado nenhum fornecedor, disponibilizar possibilidade de indicação
                        if (DocumentoVisualizacaoForm.retornaDocumento().atividadeId == '2') {
                            $('.indicacao').text('Indicação de Fornecedor?');
                            $('.dados-fornecedor-indicado').hide();
                        } else if (
                            $('#CAMPO_22').val() == '' &&
                            $('#CAMPO_23').val() == '' &&
                            $('#CAMPO_24').val() == '' &&
                            $('#CAMPO_35').val() == ''
                        ) {
                            $('.indicacao').text('Indicação de Fornecedor?');
                            $('.dados-fornecedor-indicado').hide();
                        } else {
                            $('.indicacao').text('Fornecedor Indicado');
                        }
                    }, 1000);

                    setTimeout(() => {
                        $('CAMPO_58').val(DocumentoVisualizacaoForm.documentoId());
                        $('#CAMPO_28, #CAMPO_29').on('change', function() {
                            if (
                                $('#CAMPO_28').val() != '' &&
                                $('#CAMPO_29').val() != ''
                            ) {
                                var dataInicio = $('#CAMPO_28')
                                    .val()
                                    .split('/');
                                var dataFim = $('#CAMPO_29')
                                    .val()
                                    .split('/');
                                var dataInicioFormat = new Date(
                                    `${dataInicio[2]}-${dataInicio[1]}-${dataInicio[0]}T00:00:00`
                                );
                                var dataFimFormat = new Date(
                                    `${dataFim[2]}-${dataFim[1]}-${dataFim[0]}T00:00:00`
                                );

                                if (dataInicioFormat > dataFimFormat) {
                                    Ecm.alertErro(
                                        'Data de inicio não pode ser maior que a data fim!'
                                    );
                                    $('#CAMPO_28').val('');
                                    $('#CAMPO_29').val('');
                                }
                            }
                        });

                        $('#CAMPO_30, #CAMPO_31').on('change', function() {
                            if (
                                $('#CAMPO_30').val() != '' &&
                                $('#CAMPO_31').val() != ''
                            ) {
                                var dataInicio = $('#CAMPO_30')
                                    .val()
                                    .split('/');
                                var dataFim = $('#CAMPO_31')
                                    .val()
                                    .split('/');
                                var dataInicioFormat = new Date(
                                    `${dataInicio[2]}-${dataInicio[1]}-${dataInicio[0]}T00:00:00`
                                );
                                var dataFimFormat = new Date(
                                    `${dataFim[2]}-${dataFim[1]}-${dataFim[0]}T00:00:00`
                                );

                                if (dataInicioFormat > dataFimFormat) {
                                    Ecm.alertErro(
                                        'Data de inicio não pode ser maior que a data fim!'
                                    );
                                    $('#CAMPO_30').val('');
                                    $('#CAMPO_31').val('');
                                }
                            }
                        });
                    }, 1000);

                    setTimeout(() => {
                        if (DocumentoVisualizacaoForm.retornaDocumento().atividadeId == '2' && $(controles.inputs.campo09).val() == '') {
                            numSolicitacoes();
                            criaNumeroDaSolicitacao();
                        }

                        var camposASeremDesabilitados = [
                            controles.inputs.campo01,
                            controles.inputs.campo02,
                            controles.inputs.campo09,
                            controles.inputs.campo10,
                            controles.inputs.campo36,
                            controles.inputs.campo37
                        ].join(', ');

                        $(camposASeremDesabilitados).prop('disabled', true);
                    }, 300);

                    setTimeout(() => {
                        if (!$('.acm_tbra input').val()) {
                            $('.acm_tbra').hide();
                        }
                    }, 400);

                    $('.field-anexos span').hide();
                    $('.cancelar').hide();
                    $('.aba-solicitante').trigger('click');
                    $(controles.inputs.campo13).trigger('change');

                    FormularioAnexo.eventListener.verificaCampoAnexo = verificaCampoAnexo;

                    verificarAnexosExistentes();
                }

                function onChangeCampo13(event) {
                    let modeloCompra = $(event.target)
                        .find('option:selected')
                        .text();
                    configurarModeloCompra(modeloCompra);
                }

                function onChangeCampo16(event) {
                    var value = event.target.value;
                    deixaCamposVermelhosSelect(event.target);
                }

                function onChangeCampo17(event) {
                    var value = event.target.value;
                    deixaCamposVermelhosSelect(event.target);
                }

                function onChangeCampo68(event) {
                    var value = event.target.value;
                    deixaCamposVermelhosSelect(event.target);
                }

                function onClickAbaCompra (event, $element) {
                    $('.form-solicitante').fadeOut(200, () => $('.form-compra').fadeIn());
                    $('.abas').find('li').css('background-color', '');
                    $element.closest('li').css({ 'background-color': '#d6ddff' });
                    alteraGestor();
                }

                function onClickAbaSolicitante (event, $element) {
                    $('.form-compra').fadeOut(200, () => $('.form-solicitante').fadeIn());
                    $('.abas').find('li').css('background-color', '');
                    $element.closest('li').css({ 'background-color': '#d6ddff' });
                }

                function onClickAddNumeroRv(event, $element) {
                    tabelaGrid.btnAdicionarTr($element);
                }

                function onClickIndicacao (event, $element) {
                    if (event && event.detail !== 1)
                        return;

                    var $botao = $($element);

                    if ($botao.text() == "Indicação de Fornecedor?") {
                        $(".dados-fornecedor-indicado").slideDown();
                        $botao.text("Cancelar Indicação do Fornecedor");
                        $botao.removeClass("btn-primary");
                        $botao.addClass("btn-danger");
                    } else if ($botao.text() == "Fornecedor Indicado") {
                    } else {
                        $(".dados-fornecedor-indicado").slideUp();
                        $botao.text("Indicação de Fornecedor?");
                        $botao.removeClass("btn-danger");
                        $botao.addClass("btn-primary");
                    }
                }

                function onClickSalvar(event) {
                    var $btn = $('.botoes').find('.salvar');
                    $btn.trigger('click');
                }

                function onClickCloseModal (event) {
                    gerarHistoricoCampo34();
                }

                function onClickAddFornecedor(event) {
                    $('.js-contentFornecedorIndicacao2').slideDown();
                }

                function onClickRemoverFornecedor(event) {
                    var camposResets = ['#CAMPO_73', '#CAMPO_74', '#CAMPO_75', '#CAMPO_76','#CAMPO_77'];
                    $('.js-contentFornecedorIndicacao2').slideUp(function () {
                        camposResets.forEach(function (campo, index) {
                            $(document.body).find(campo).val('');
                        });
                    });
                }

                function verificaCampoAnexo (data) {
                    anexosRealizados = data;
                }

                function carregarHistoricoNaTabela() {
                    if (!contadorFuncao) {
                        if ($('#cke_CAMPO_34 iframe').length) {
                            setTimeout(function() {
                                String.prototype.stripHTML = function() {
                                    return this.replace(/<.*?>/g, '');
                                };

                                var tabelaHistorico = $('#tabelaHistorico');
                                tabelaHistorico.find('td').remove();
                                var dataSet;
                                try {
                                    var campoHistorico = $(
                                        '#cke_CAMPO_34 iframe'
                                    )[0].contentWindow.document.querySelectorAll(
                                        'html body'
                                    )[0].textContent;

                                    dataSet = JSON.parse(campoHistorico);

                                    atualizarTabelaHistorico(
                                        tabelaHistorico,
                                        dataSet
                                    );
                                } catch (e) {
                                    console.log('Tabela Histo não existe!');
                                    dataSet = '';
                                    atualizarTabelaHistorico(
                                        tabelaHistorico,
                                        dataSet
                                    );
                                }
                            }, 1000);
                            ++contadorFuncao;
                        } else {
                            setTimeout(carregarHistoricoNaTabela, 1000);
                        }
                    }
                }

                function atualizarTabelaHistorico(tabelaHistorico, dataSet) {
                    tabelaHistorico.DataTable({
                        data: dataSet,
                        destroy: true,
                        columns: [
                            { data: 'dataHora' },
                            { data: 'usuario' },
                            { data: 'historico' }
                        ],
                        order: [[0, 'desc']],
                        language: {
                            aria: {
                                sortAscending: ': ordenar crescente',
                                sortDescending: ': ordenar decrescente'
                            },
                            emptyTable: 'Nenhum resgistro',
                            info: '',
                            infoEmpty: 'Nenhum registro',
                            infoFiltered: '(filtrado de MAX registros)',
                            lengthMenu: '',
                            search: 'Filtrar:',
                            zeroRecords: 'Nenhum resgistro',
                            paginate: {
                                previous: 'Anterior',
                                next: 'Próximo',
                                last: 'Ultimo',
                                first: 'primeiro'
                            }
                        }
                    });
                }

                function criaNumeroDaSolicitacao () {
                    var ano = new Date();
                    var data = [];

                    var anoDoisDig = ano.getFullYear().toString().substr(-2);

                    data.push({
                        Id: 9,
                        tipoDocumentalId: 35,
                        colunaTipo: 'C',
                        comparacao: 7,
                        valor: anoDoisDig
                    });

                    var objData = JSON.stringify(data);

                    PesquisaDocumentos(objData);
                }

                function numSolicitacoes () {
                    var url_atual = window.location.href;
                    var token = Ecm.token;

                    var settings = {
                        url: url_atual.split('Autenticado')[0] + '/api/auth/token',
                        method: 'POST',
                        timeout: 0,
                        headers: {
                            'Content-Type': 'application/json',
                            Authorization:
                                'bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjEsImdpZCI6WzEsMl0sIm5hbWUiOiJhZG1pbiIsImV4cCI6NjM3MDg0ODYxMDY2ODA1OTkwLCJpYXQiOjB9.dn4wPqJCSzHCLHquWIqlK4543B5HFlvJYTs6DeCJsAg'
                        },
                        data: JSON.stringify({
                            usuario: 'admin',
                            senha: 'tgestiona@2020'
                        })
                    };

                    $.ajax(settings).done(function(response) {
                        var settings = {
                            async: false,
                            url: url_atual.split('Autenticado')[0] + '/api/v2/processos/11/atividades/2/instancias',
                            method: 'GET',
                            headers: {
                                'content-type': 'application/json',
                                authorization: response.token
                            },
                            processData: false
                        };

                        $.ajax(settings).done(function(documentos) {
                            if (documentos.data.length > 1) {
                                var ultSolicitacao = documentos.data.reduce(
                                    function(current, next) {
                                        var atual = 0;

                                        if (typeof current == 'object') {
                                            let valor = current.camposValor.length == 0 || !current.camposValor ? 0 : current.camposValor[8].valor;
                                            atual = parseInt(valor) || 0;
                                        } else {
                                            atual = current;
                                        }

                                        var prox = next.camposValor.length ? (parseInt(next.camposValor[8].valor) || 0 ) : 0;
                                        return atual > prox ? atual : prox;
                                    }
                                );

                                solicitacaoAtv1 = ultSolicitacao;
                            } else {
                                solicitacaoAtv1 = documentos.data[0].camposValor.length ? (parseInt(documentos.data[0].camposValor[8].valor) || 0) : 0;
                            }

                            $(controles.inputs.campo10).val(new Date().toLocaleDateString());
                        });
                    });
                }

                function PesquisaDocumentos (data) {
                    var url_atual = window.location.href;
                    var token = Ecm.token;

                    var settings = {
                        url: url_atual.split('Autenticado')[0] + '/api/auth/token',
                        method: 'POST',
                        timeout: 0,
                        headers: {
                            'Content-Type': 'application/json',
                            Authorization:
                                'bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjEsImdpZCI6WzEsMl0sIm5hbWUiOiJhZG1pbiIsImV4cCI6NjM3MDg0ODYxMDY2ODA1OTkwLCJpYXQiOjB9.dn4wPqJCSzHCLHquWIqlK4543B5HFlvJYTs6DeCJsAg'
                        },
                        data: JSON.stringify({
                            usuario: 'admin',
                            senha: 'tgestiona@2020'
                        })
                    };

                    $.ajax(settings).done(function(response) {
                        var settings = {
                            async: false,
                            url:
                                url_atual.split('Autenticado')[0] +
                                'api/v2/documentos/pesquisar/35/quantidade/1000/retornarAnexos/true',
                            method: 'POST',
                            headers: {
                                'content-type': 'application/json',
                                authorization: response.token
                            },
                            processData: false,
                            data: data
                        };

                        $.ajax(settings)
                            .done(function(res) {
                                if (res != undefined) {
                                    var lastDoc = res.reduce(function(
                                        current,
                                        next
                                    ) {
                                        var atual = parseInt(
                                            current.camposValor[8] != undefined
                                                ? current.camposValor[8].valor
                                                : current
                                        );
                                        var prox =
                                            parseInt(
                                                next.camposValor[8].valor
                                            ) || 0;

                                        return atual > prox ? current : next;
                                    });

                                    solicitacaoAtv1 = isNaN(solicitacaoAtv1)
                                        ? 0
                                        : solicitacaoAtv1;
                                    lastDoc =
                                        parseInt(lastDoc.camposValor[8].valor) >
                                        solicitacaoAtv1
                                            ? parseInt(
                                                  lastDoc.camposValor[8].valor
                                              )
                                            : solicitacaoAtv1;

                                    $(controles.inputs.campo09).val(
                                        lastDoc + 1
                                    );
                                } else {
                                    var ano = new Date();
                                    var numSolicNovo = parseInt(
                                        ano
                                            .getFullYear()
                                            .toString()
                                            .substr(-2) + '0000'
                                    );
                                    var soli =
                                        solicitacaoAtv1 > numSolicNovo
                                            ? solicitacaoAtv1
                                            : numSolicNovo;

                                    $(controles.inputs.campo09).val(soli + 1);
                                }
                            })
                            .fail(() => {
                                var ano = new Date();
                                var numSolicNovo = parseInt(
                                    ano
                                        .getFullYear()
                                        .toString()
                                        .substr(-2) + '0000'
                                );
                                var soli =
                                    solicitacaoAtv1 > numSolicNovo
                                        ? solicitacaoAtv1
                                        : numSolicNovo;

                                $(controles.inputs.campo09).val(soli + 1);
                            });
                    });
                }

                function eventoVerificaCampoPreenchido(campo) {
                    if ($(campo).attr('id') == 'CAMPO_13') {
                        deixaCamposVermelhosSelect('#CAMPO_16');
                        deixaCamposVermelhosSelect('#CAMPO_17');
                        deixaCamposVermelhosSelect('#CAMPO_68');
                        $('#CAMPO_16').prop('disabled', false);
                    } else {
                        $(campo).on('keyup', function() {
                            deixaCamposVermelhosSelect(campo);
                        });
                    }
                }

                function deixaCamposVermelhosSelect(campo) {
                    let modeloCompra = $('#CAMPO_13 option:selected').text();
                    let campoValor = $(`#${$(campo).attr('id')} option:selected`).text();

                    if (DocumentoVisualizacaoForm.retornaDocumento().atividadeId == 2) {
                        if (
                            modeloCompra != 'Nova Contratação' &&
                            (campoValor == 'Selecione' || campoValor == '')
                        ) {
                            if (campo != '') {
                                $(campo).css({ border: '2px solid red' });
                                $(campo).prop('required', true);
                            }
                        } else {
                            $(campo).css({
                                border: 'none',
                                borderBottom: '1px solid #c2cad8'
                            });
                            $(campo).prop('required', false);
                        }
                    }
                }

                function configurarModeloCompra(modeloCompra) {
                    var camposRequired = ['#CAMPO_22', '#CAMPO_51'];
                    definirAnexosObrigatorios(modeloCompra);

                    if ( modeloCompra == 'Adesão a um contrato vigente (Empresas do Grupo)' ) {
                        $('.acm_tbra').slideDown();
                    } else {
                        $('.acm_tbra').slideUp();
                        $('.acm_tbra input').val('');
                    }

                    if (modeloCompra != 'Nova Contratação') {
                        camposRequired.forEach(campo => {
                            deixaCamposVermelhosSelect(campo);
                        });
                    } else {
                        camposRequired.forEach(campo => {
                            $(campo).val('');
                            $(campos).prop('required', false);
                            $(campos).css({
                                border: 'none',
                                borderBottom: '1px solid #c2cad8'
                            });
                        });
                    }

                    if (
                        modeloCompra === 'Nova Contratação'
                        || modeloCompra === 'Nova Contratação Condicionada'
                        || modeloCompra === 'Adesão a um contrato vigente (Empresas do Grupo)'
                    ) {
                        $('#CAMPO_52').val('');
                        $('#CAMPO_52').prop('required', false);
                        $('#CAMPO_52').css({
                            border: 'none',
                            borderBottom: '1px solid #c2cad8'
                        });
                    }
                    else {
                        deixaCamposVermelhosSelect('#CAMPO_52');
                    }

                    camposRequired.forEach(campo => {
                        eventoVerificaCampoPreenchido(campo);
                    });
                }

                function definirAnexosObrigatorios(modeloCompra) {
                    anexosObrigatorios = new Set();
                    $('.label-input-file').removeClass('required');

                    switch (modeloCompra) {
                        case 'Adesão a um contrato vigente (Empresas do Grupo)':
                        case 'Alteração de objeto contratual (inclusão de escopo)': {
                            anexosObrigatorios = new Set([
                                'MEMORANDO-CONDICIONAMENTO',
                                'PXQ',
                                'RV-APROVADA'
                            ]);

                            $('#CAMPO_30, #CAMPO_31').prop('required', false);
                            $('#CAMPO_51, #CAMPO_22').val('');
                            break;
                        }
                        case 'Negociação de reajuste': {
                            anexosObrigatorios = new Set([
                                'MEMORANDO-CONDICIONAMENTO',
                                'PXQ',
                                'RV-APROVADA',
                                'ACORDO-CDG'
                            ]);

                            $('#CAMPO_30, #CAMPO_31').prop('required', false);
                            $('#CAMPO_51, #CAMPO_22').val('');
                            break;
                        }
                        case 'Normativas': {
                            anexosObrigatorios = new Set(['PXQ']);
                            $('#CAMPO_30, #CAMPO_31').prop('required', true);
                            $('#CAMPO_51, #CAMPO_22').val('');
                            break;
                        }
                        case 'Nova Contratação': {
                            anexosObrigatorios = new Set([
                                'PROJETO-BASICO',
                                'PXQ',
                                'RV-APROVADA'
                            ]);

                            $('#CAMPO_30, #CAMPO_31, #CAMPO_51, #CAMPO_22').prop('required', false);
                            $('#CAMPO_30, #CAMPO_31, #CAMPO_51, #CAMPO_22').val('');
                            $('#CAMPO_51, #CAMPO_22').css('border', 'none');
                            break;
                        }
                        case 'Nova Contratação Condicionada': {
                            anexosObrigatorios = new Set([
                                'MEMORANDO-CONDICIONAMENTO',
                                'PROJETO-BASICO',
                                'PXQ',
                                'RV-APROVADA'
                            ]);
                            $('#CAMPO_30, #CAMPO_31').prop('required', false);
                            $('#CAMPO_51, #CAMPO_22').val('');
                            break;
                        }
                        case 'Prorrogação de vigência contratual': {
                            anexosObrigatorios = new Set([
                                'MEMORANDO-CONDICIONAMENTO',
                                'PXQ',
                                'RV-APROVADA'
                            ]);
                            $('#CAMPO_30, #CAMPO_31').prop('required', true);
                            $('#CAMPO_51, #CAMPO_22').val('');
                            break;
                        }
                        case 'Prorrogação de vigência contratual com suplementação de verba':
                        case 'Prorrogação de vigência do contrato SAP para regularização de pagamento de NF':
                        case 'Regularização de Compra':
                        case 'Remanejamento de Verba entre contratos':
                        case 'Suplementação de verba dentro de vigência contratual': {
                            if (
                                modeloCompra ==
                                    'Prorrogação de vigência do contrato SAP para regularização de pagamento de NF' ||
                                modeloCompra ==
                                    'Prorrogação de vigência contratual com suplementação de verba'
                            ) {
                                $('#CAMPO_30, #CAMPO_31').prop(
                                    'required',
                                    true
                                );
                            } else {
                                $('#CAMPO_30, #CAMPO_31').prop(
                                    'required',
                                    false
                                );
                            }

                            anexosObrigatorios = new Set([
                                'MEMORANDO-CONDICIONAMENTO',
                                'PXQ',
                                'RV-APROVADA'
                            ]);

                            $('#CAMPO_51, #CAMPO_22').val('');
                            break;
                        }
                        default:
                            break;
                    }

                    $('#js-listagem-anexos li').each((id, element) => {
                        var $el = $(element);
                        var state = $el.data('state');

                        if (state && state.anexo) {
                            var nameAnexo = state.anexo.nomeOriginal;
                            nameAnexo = nameAnexo
                                ? nameAnexo.split('.')[0]
                                : null;
                            nameAnexo && anexosRealizados.add(nameAnexo);
                        }
                    });

                    if (anexosObrigatorios.size > 0) {
                        anexosObrigatorios.forEach(function(nameAnexo) {
                            //esse item nao faz sentido por isso esta desativado
                            // $(`[${nameAnexo}]`).addClass('anexo-obrigatorio');
                            $(
                                '.label-input-file[for="' + nameAnexo + '"]'
                            ).addClass('required');
                        });
                    }
                }

                function ordenaSelect(campo) {
                    $(campo)
                        .find('option')
                        .each((i, option) => {
                            if ($(option).text() == 'Selecione') {
                                $(option).insertBefore(
                                    $(campo + ' option').first()
                                );
                            }
                        });
                }

                function executarFuncao(callback, qtdTry, interval = 50) {
                    var counter = 0;
                    function subFunc(exeCall) {
                        try {
                            exeCall();
                            counter++;
                        } catch {
                            if (counter <= qtdTry)
                                setTimeout(() => subFunc(exeCall), interval);
                            console.log('tentativas...');
                        }
                    }
                    subFunc(callback);
                }

                function diferenca(setA, setB) {
                    var _diferenca = new Set(setA);

                    for (var elem of setB) {
                        _diferenca.delete(elem);
                    }
                    return _diferenca;
                }

                function verificarNumeroRV (callback) {
                    try {
                        var modeloCompra = $(controles.inputs.campo13).find('option:selected').text();

                        if (modeloCompra === 'Normativas' || modeloCompra === 'Desbloqueio do contrato SAP') {
                            if (typeof callback === 'function')
                                callback();
                            return;
                        }

                        var $table = $(document.body).find('#numeroRv');
                        var $inputs = $table.find('[data-input="numeroRv"]');

                        if (!$inputs.length)
                            throw ({description : 'obrigatorio' });

                        $.each($inputs, function (index, element) {
                            var value = $(element).val();
                            if (!value) {
                                throw ({description : 'obrigatorio' });
                            }
                        });

                        if (typeof callback === 'function')
                            callback();

                    } catch (error) {
                        if ('description' in error) {
                            toastr.warning('Preencha todos os campos Número RV disponiveis!');
                        }
                    }
                }

                function verificarCampoPreenchido ($element, defaultValue) {
                    var value = $element.val();
                    if (!value)
                        $element.val(defaultValue);
                }

                function toTitleCase(str) {
                    return str
                        .toLowerCase()
                        .replace(/(?:^|\s)\w/g, function(match) {
                            return match.toUpperCase();
                        });
                }

                function verficaCampoPreenchido(campo) {
                    var modeloCompra = $('#CAMPO_13 option:selected').text();
                    if (campo.value == '') {
                        if (modeloCompra !== 'Nova Contratação') {
                            $(campo).css({ border: '1px solid red' });
                            $(campo).prop('required', true);
                        }
                        else {
                            $(campo).css({ border: '1px solid #c2cad8'});
                        }
                    } else {
                        $(campo).css({ border: '1px solid #c2cad8'});
                        $(campo).prop('required', false);
                    }
                }

                function insereIdGestorNoCampo() {
                    var idGrupo = 0;
                    var estruturaBeneficiada = $(controles.inputs.campo16)
                        .find('option:selected')
                        .text();
                    var nomeGestorContrato = $(controles.inputs.campo68)
                        .find('option:selected')
                        .text();
                    var token = Ecm.token;
                    var url_atual = window.location.href;
                    var settings = {
                        url:
                            url_atual.split('Autenticado')[0] +
                            'api/auth/token',
                        method: 'POST',
                        timeout: 0,
                        headers: {
                            'Content-Type': 'application/json',
                            Authorization:
                                'bearer "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjEsImdpZCI6WzEsMl0sIm5hbWUiOiJhZG1pbiIsImV4cCI6NjM3MDg0ODYxMDY2ODA1OTkwLCJpYXQiOjB9.dn4wPqJCSzHCLHquWIqlK4543B5HFlvJYTs6DeCJsAg"'
                        },
                        data: JSON.stringify({
                            usuario: 'admin',
                            senha: 'tgestiona@2020'
                        })
                    };

                    $.ajax(settings).done(function(response) {
                        var settings = {
                            url:
                                url_atual.split('Autenticado')[0] +
                                'api/v2/grupos',
                            method: 'GET',
                            timeout: 0,
                            headers: {
                                'content-type': 'application/json',
                                authorization: response.token
                            }
                        };

                        $.ajax(settings).done(function(grupo) {
                            var grupoSelecionado = grupo.filter(function(g) {
                                return g.nome == estruturaBeneficiada;
                            })[0];

                            idGrupo = grupoSelecionado
                                ? grupoSelecionado.id
                                : 0;

                            Ecm.retornaUsuariosDoGrupo(idGrupo, function(
                                response
                            ) {
                                var gestorSelecionado = response.usuarios.filter(
                                    function(user) {
                                        return user.Nome == nomeGestorContrato;
                                    }
                                )[0];
                                var idUsuario = gestorSelecionado
                                    ? gestorSelecionado.Id
                                    : 0;

                                $(controles.inputs.campo69).val(idUsuario);
                            });
                        });
                    });
                }

                function alteraGestor() {
                    $('#CAMPO_68').on('change', insereIdGestorNoCampo);
                    $('#CAMPO_28, #CAMPO_29').prop('required', true);
                }

                function armazenaFornecedores() {
                    var razaoSocial = '';
                    var cnpj = '';
                    var pessoaContato = '';
                    var tel = '';
                    var email = '';
                    var count = 1;
                    var fornecedoresCampos = [];

                    Array.from($('.fornecedores input')).forEach(
                        (input, i, array) => {
                            if (count <= 5) {
                                switch (count) {
                                    case 1:
                                        razaoSocial = $(input).val();
                                        break;
                                    case 2:
                                        cnpj = $(input).val();
                                        break;
                                    case 3:
                                        pessoaContato = $(input).val();
                                        break;
                                    case 4:
                                        tel = $(input).val();
                                        break;
                                    case 5:
                                        email = $(input).val();
                                        break;
                                }
                                $(input).val();
                                count++;
                            } else {
                                count = 1;
                            }
                            if (count == 6) {
                                fornecedoresCampos.push({
                                    razaoSocial,
                                    cnpj,
                                    pessoaContato,
                                    tel,
                                    email
                                });
                            }
                            if (i == array.length - 1) {
                                fornecedoresCampos.push({
                                    razaoSocial,
                                    cnpj,
                                    pessoaContato,
                                    tel,
                                    email
                                });
                            }
                        }
                    );

                    $(
                        '#cke_CAMPO_71 iframe'
                    )[0].contentWindow.document.querySelectorAll(
                        'html body'
                    )[0].textContent = JSON.stringify(fornecedoresCampos);
                }

                function verificarAnexosExistentes () {
                    $('#js-listagem-anexos li').each((id, element) => {
                        var $el = $(element);
                        var state = $el.data('state');

                        if (state && state.anexo) {
                            var nameAnexo = state.anexo.nomeOriginal;
                            nameAnexo = nameAnexo ? nameAnexo.split('.')[0] : null;

                            $(document.body).find('[for="' + nameAnexo + '"]').addClass('blue');
                        }
                    });
                }

                function executarFuncao(callback, nTentativas) {
                    var tentativas = 0;
                    function subFunc() {
                        try {
                            if (tentativas < nTentativas) callback();
                        } catch {
                            tentativas++;
                            setTimeout(subFunc, 800);
                        }
                    }
                    subFunc();
                }

                function gravarHistoricoNoHTML(callback) {
                    armazenaFornecedores();
                    gerarHistoricoCampo34();

                    if (typeof callback === 'function') callback();
                }

                function gerarHistoricoCampo34 () {
                    if (contadorGravarHist == 0) {
                        if ($('#obs').val() != '') {
                            var historico = $('#cke_CAMPO_34 iframe')[0].contentWindow.document.querySelectorAll('html body')[0].textContent;
                            var dateTime = moment().format('DD/MM/YYYY HH:mm:ss')

                            var usuarioLogado = Ecm.retornaUsuario();

                            var historico2 = [];

                            if (historico == '') {
                                //se for o primeiro historico, ou seja, se o historico estiver vazio
                                historico2.push(
                                    JSON.parse(
                                        '{ "dataHora": "' +
                                            dateTime +
                                            '", "usuario": "' +
                                            usuarioLogado.nome +
                                            '", "historico": "' +
                                            $('#obs').val() +
                                            '" }'
                                    )
                                );
                                $(
                                    '#cke_CAMPO_34 iframe'
                                )[0].contentWindow.document.querySelectorAll(
                                    'html body'
                                )[0].textContent = JSON.stringify(historico2);
                            } else {
                                //se não for o primeiro historico, ou seja, se o historico estiver preenchido

                                var tempObservacao = JSON.parse(
                                    '{ "dataHora": "' +
                                        dateTime +
                                        '", "usuario": "' +
                                        usuarioLogado.nome +
                                        '", "historico": "' +
                                        $('#obs').val() +
                                        '" }'
                                );

                                var tempHistorico = JSON.parse($('#cke_CAMPO_34 iframe')[0].contentWindow.document.querySelectorAll('html body')[0].textContent);

                                if ($('#obs').length <= 0) {
                                    Ecm.alertErro(
                                        'Ocorreu um erro ao tentar gravar as informações na tabela.',
                                        'Erro ao gravar o Histórico',
                                        3
                                    );
                                    return false;
                                }

                                tempHistorico.push(tempObservacao);

                                $(
                                    '#cke_CAMPO_34 iframe'
                                )[0].contentWindow.document.querySelectorAll(
                                    'html body'
                                )[0].textContent = JSON.stringify(
                                    tempHistorico
                                );
                            }
                        }
                        ++contadorGravarHist;
                    }

                }

                function verificaAnexosNaoEnviados(event) {
                    var anexosMensagem = '';
                    var _documento = DocumentoVisualizacaoForm.retornaDocumento();
                    var valorCampo13 = $(controles.inputs.campo13).val();

                    if (_documento.atividadeId == 2 && valorCampo13) {
                        if ( _documento.atividadeId != 2 || anexosRealizados.size >= anexosObrigatorios.size ) {
                            var anexosNaoEnviados = diferenca(anexosObrigatorios, anexosRealizados);

                            if ( _documento.atividadeId == 2 && anexosNaoEnviados.size > 0 ) {
                                anexosNaoEnviados.forEach( nomeAnexo => (anexosMensagem += nomeAnexo + '<br>') );
                                Ecm.alertErro( `Envie os anexos Obrigatórios! ${toTitleCase( anexosMensagem )}` );
                            } else {
                                gravarHistoricoNoHTML(function() {
                                    verificarNumeroRV(function () {
                                        var getId ='#' + $(event.target).attr('id');
                                        DocumentoVisualizacaoForm.publicarSaida(getId);
                                    });
                                });
                            }
                        } else {
                            var anexosNaoEnviados = diferenca(anexosObrigatorios, anexosRealizados);
                            anexosNaoEnviados.forEach( nomeAnexo => (anexosMensagem += nomeAnexo + '<br>') );
                            Ecm.alertErro( `Envie os anexos Obrigatórios! <br> ${toTitleCase( anexosMensagem )}` );
                        }
                    } else if (!valorCampo13) {
                        Ecm.alertErro( `preencha o modelo de compra e os campos Obrigatórios!<br> ${toTitleCase( anexosMensagem )}` );
                    } else {
                        gravarHistoricoNoHTML(function() {
                            var getId ='#' + $(event.target).attr('id');
                            DocumentoVisualizacaoForm.publicarSaida(getId);
                        });
                    }
                }

                function renderizarBotaoSuperior (transicaoSaidas) {
                    var $container = $('.botoes');
                    $container.find('.btn-superior').remove();
                    $container.find('.btn').hide();

                    for (var index in transicaoSaidas) {
                        var saida = transicaoSaidas[index];
                        var $sd = $(document.body).find('#transicao-id-' + saida.Id);

                        if (!$sd.length)
                            continue;

                        var $btnTransacaoSaida = $('<a />');
                        $btnTransacaoSaida
                        .attr('id', 'transicao-id-' + saida.Id)
                        .attr('href', 'javascript:')
                        .addClass('btn btn-sm btn-primary btn-superior')
                        .css({
                            'display': 'inline-block',
                            'margin-right': '10px',
                            'background-color': saida.Cor,
                            'border-color': saida.Cor,
                        })
                        .on('click', verificaAnexosNaoEnviados)
                        .html(saida.Nome);

                        $btnTransacaoSaida.appendTo($container);
                    }
                }

                function renderizarBotaoInferior (transicaoSaidas) {
                    var $tabPane = $('.tab-pane');
                    $tabPane.find('.btn-inferior').remove();

                    for (var index in transicaoSaidas) {
                        var saida = transicaoSaidas[index];
                        var $sd = $(document.body).find('#transicao-id-' + saida.Id);

                        if (!$sd.length)
                            continue;

                        var $btnTransacaoSaida = $('<a />');
                        $btnTransacaoSaida
                        .attr('id', 'transicao-id-' + saida.Id)
                        .attr('href', 'javascript:')
                        .addClass('btn btn-sm btn-primary btn-inferior')
                        .css({
                            'display': 'inline-block',
                            'margin-right': '10px',
                            'background-color': saida.Cor,
                            'border-color': saida.Cor,
                        })
                        .on('click', verificaAnexosNaoEnviados)
                        .html(saida.Nome);

                        $btnTransacaoSaida.appendTo($('.tab-pane'));
                    }
                }

                function retornaAtividadeSaidasSuccesso (props) {
                    renderizarBotaoSuperior(props.transicaoSaidas);
                    renderizarBotaoInferior(props.transicaoSaidas);
                }

                return {
                    init: init,
                    retornaAtividadeSaidasSuccesso: retornaAtividadeSaidasSuccesso,
                };

            })();

            DocumentoVisualizacaoForm.eventListerner.retornaAtividadeSaidasSuccesso = FormularioFase1.retornaAtividadeSaidasSuccesso;
            DocumentoVisualizacaoForm.camposCarregados(FormularioFase1.init);
        </script>
    </body>
</html>
